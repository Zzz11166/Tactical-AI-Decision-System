<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.airag.data.mapper.FileInfoMapper">

    <resultMap id="FileInfoResultMap" type="com.spring.airag.data.entity.FileInfoEntity">
        <id column="id" property="id"/>
        <result column="original_name" property="originalName"/>
        <result column="file_name" property="fileName"/>
        <result column="file_path" property="filePath"/>
        <result column="file_size" property="fileSize"/>
        <result column="file_type" property="fileType"/>
        <result column="file_extension" property="fileExtension"/>
        <result column="storage_type" property="storageType"/>
        <result column="upload_user_id" property="uploadUserId"/>
        <result column="upload_user_name" property="uploadUserName"/>
        <result column="business_type" property="businessType"/>
        <result column="business_id" property="businessId"/>
        <result column="status" property="status"/>
        <result column="created_at" property="createdAt"/>
        <result column="updated_at" property="updatedAt"/>
    </resultMap>

    <insert id="insert" parameterType="com.spring.airag.data.entity.FileInfoEntity">
        INSERT INTO files (
            id, original_name, file_name, file_path, file_size, file_type,
            file_extension, storage_type, upload_user_id, upload_user_name,
            business_type, business_id, status, created_at, updated_at
        ) VALUES (
            #{id}, #{originalName}, #{fileName}, #{filePath}, #{fileSize}, #{fileType},
            #{fileExtension}, #{storageType}, #{uploadUserId}, #{uploadUserName},
            #{businessType}, #{businessId}, #{status}, NOW(), NOW()
        )
    </insert>

    <select id="selectById" parameterType="string" resultMap="FileInfoResultMap">
        SELECT * FROM files WHERE id = #{id}
    </select>

    <select id="selectAll" resultMap="FileInfoResultMap">
        SELECT * FROM files ORDER BY created_at DESC
    </select>

    <select id="selectByBusinessType" parameterType="string" resultMap="FileInfoResultMap">
        SELECT * FROM files WHERE business_type = #{businessType} ORDER BY created_at DESC
    </select>

    <update id="update" parameterType="com.spring.airag.data.entity.FileInfoEntity">
        UPDATE files SET
            original_name = #{originalName},
            file_name = #{fileName},
            file_path = #{filePath},
            file_size = #{fileSize},
            file_type = #{fileType},
            file_extension = #{fileExtension},
            storage_type = #{storageType},
            upload_user_id = #{uploadUserId},
            upload_user_name = #{uploadUserName},
            business_type = #{businessType},
            business_id = #{businessId},
            status = #{status},
            updated_at = NOW()
        WHERE id = #{id}
    </update>

    <delete id="deleteById" parameterType="string">
        DELETE FROM files WHERE id = #{id}
    </delete>

    <select id="selectByFileName" parameterType="string" resultMap="FileInfoResultMap">
        SELECT * FROM files WHERE file_name = #{fileName}
    </select>

</mapper>